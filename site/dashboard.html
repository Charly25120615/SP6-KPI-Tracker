<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Dashboard BSC 2026</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body { background: linear-gradient(rgba(15,23,42,0.9), rgba(15,23,42,0.9)), url('../pared.jpg'); background-size: cover; background-attachment: fixed; }
        .glass { background: rgba(255, 255, 255, 0.95); backdrop-filter: blur(10px); border: 1px solid rgba(255,255,255,0.1); }
        /* Animación para el pulso del asesor IA */
        .pulse-blue { animation: pulse 2s cubic-bezier(0.4, 0, 0.6, 1) infinite; }
        @keyframes pulse { 0%, 100% { opacity: 1; } 50% { opacity: .5; } }
    </style>
</head>
<body class="p-6 md:p-12 text-slate-800 font-sans">
    <div class="max-w-7xl mx-auto">
        <header class="mb-10 flex justify-between items-end border-b border-white/10 pb-6">
            <div>
                <h1 class="text-white text-4xl font-black italic uppercase tracking-tighter">Dashboard Táctico</h1>
                <p class="text-red-500 font-bold">SP6 TECNOLOGÍAS 2026</p>
            </div>
            <p id="time" class="text-white/40 font-mono text-xs"></p>
        </header>

        <div id="bsc-container" class="grid grid-cols-1 md:grid-cols-4 gap-4 mb-12"></div>
        
        <div id="kpi-groups" class="space-y-12 mb-12"></div>
        
        <div class="mb-12">
            <h2 class="text-white/50 font-black text-xs uppercase tracking-widest mb-4">Desempeño por Líder</h2>
            <div id="lideres-container" class="grid grid-cols-2 md:grid-cols-5 gap-4"></div>
        </div>

        <div class="mt-16 mb-8">
            <div class="flex items-center gap-3 mb-6">
                <div class="h-1 w-12 bg-blue-600"></div>
                <h2 class="text-white text-2xl font-black uppercase tracking-tighter italic">Asesor Estratégico SP6 <span class="text-blue-500 text-xs ml-2 not-italic font-mono">v1.0-AI</span></h2>
            </div>

            <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                <div class="glass p-8 rounded-[2rem] border-l-8 border-blue-600 shadow-2xl md:col-span-2">
                    <div class="flex items-center mb-4">
                        <div class="w-2 h-2 bg-blue-500 rounded-full pulse-blue mr-2"></div>
                        <p class="text-[10px] font-bold text-blue-600 uppercase font-mono">Análisis de Seguridad y Negocio</p>
                    </div>
                    <div id="ai-estrategia" class="text-slate-700 leading-relaxed text-sm italic">
                        Cargando recomendaciones estratégicas...
                    </div>
                </div>

                <div class="bg-slate-900 p-8 rounded-[2rem] border-b-8 border-red-500 shadow-2xl">
                    <p class="text-[10px] font-bold text-red-500 uppercase mb-4 font-mono tracking-widest">⚠️ Riesgos Detectados</p>
                    <ul id="ai-alertas" class="text-white text-xs space-y-4 font-mono list-none">
                        <li class="border-l border-red-500/30 pl-3">> ESCANEANDO MÉTRICAS...</li>
                    </ul>
                </div>
            </div>
        </div>
    </div>

    <script>
        const getCol = (n) => n >= 90 ? 'text-green-600' : n >= 80 ? 'text-yellow-600' : 'text-red-600';
        const getBg = (n) => n >= 90 ? 'bg-green-500' : n >= 80 ? 'bg-yellow-500' : 'bg-red-500';
        const getBorder = (n) => n >= 90 ? 'border-green-500' : n >= 80 ? 'border-yellow-500' : 'border-red-500';

        async function load() {
            const res = await fetch('data.json');
            const data = await res.json();
            document.getElementById('time').innerText = `Sync: ${data.lastUpdate}`;

            // 1. Render Resumen
            document.getElementById('bsc-container').innerHTML = data.bscData.map(i => `
                <div class="${getBg(i.nota)} p-6 rounded-2xl text-white shadow-lg">
                    <p class="text-[10px] font-bold uppercase opacity-60">${i.categoria}</p>
                    <p class="text-3xl font-black">${i.nota.toFixed(1)}%</p>
                </div>
            `).join('');

            // 2. Render Grupos de KPIs
            const groups = data.kpis.reduce((acc, k) => {
                acc[k.categoria] = acc[k.categoria] || [];
                acc[k.categoria].push(k);
                return acc;
            }, {});

            document.getElementById('kpi-groups').innerHTML = Object.entries(groups).map(([cat, kpis]) => `
                <div>
                    <h3 class="text-white/80 text-lg font-black mb-4 uppercase border-l-4 border-blue-500 pl-3">${cat}</h3>
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                        ${kpis.map(k => `
                            <div class="glass p-6 rounded-[2rem] border-b-8 ${getBorder(k.nota)} shadow-xl">
                                <p class="text-[10px] font-bold text-slate-400 uppercase mb-2">${k.categoria}</p>
                                <p class="font-bold text-slate-800 text-lg leading-tight h-12 mb-6">${k.nombre}</p>
                                <div class="flex justify-between items-end">
                                    <div>
                                        <p class="text-[10px] font-bold text-slate-400">LOGRO</p>
                                        <p class="text-4xl font-black ${getCol(k.nota)}">${k.nota}%</p>
                                    </div>
                                    <div class="text-right">
                                        <p class="text-[10px] font-bold text-slate-400">META</p>
                                        <p class="font-black text-slate-600 text-xs">${k.meta}</p>
                                    </div>
                                </div>
                            </div>
                        `).join('')}
                    </div>
                </div>
            `).join('');

            // 3. Render Líderes
            document.getElementById('lideres-container').innerHTML = data.lideres.map(l => `
                <div class="glass p-4 rounded-xl text-center border-t-4 ${getBorder(l.nota)}">
                    <p class="text-[10px] font-bold text-slate-400 uppercase">Responsable</p>
                    <p class="font-bold text-slate-700 text-sm truncate">${l.nombre}</p>
                    <p class="text-xl font-black ${getCol(l.nota)}">${l.nota}%</p>
                </div>
            `).join('');

            // 4. Lógica de la Sección IA (Simulada por ahora)
            if(data.kpis) {
                const financierosBajos = data.kpis.filter(k => k.categoria.includes("Financiero") && k.nota < 80);
                const procesosAltos = data.kpis.filter(k => k.categoria.includes("Procesos") && k.nota >= 95);
                
                document.getElementById('ai-estrategia').innerHTML = `
                    "Basado en los datos actuales, SP6 presenta una robustez técnica excepcional en la sección de <b>Procesos</b> (${procesosAltos.length} indicadores en verde), lo cual es crítico para la confianza en seguridad digital. Sin embargo, se detecta una brecha en la conversión financiera. Se recomienda alinear los cronogramas de facturación con la entrega técnica para optimizar el flujo de caja sin comprometer la calidad del servicio."
                `;
                
                document.getElementById('ai-alertas').innerHTML = financierosBajos.length > 0 
                    ? financierosBajos.map(k => `<li class="border-l border-red-500 pl-3">> BAJO RENDIMIENTO: ${k.nombre}</li>`).join('')
                    : `<li class="border-l border-green-500 pl-3">> SIN RIESGOS CRÍTICOS DETECTADOS</li>`;
            }
        }
        load();
    </script>
</body>
</html>
